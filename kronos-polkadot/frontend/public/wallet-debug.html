<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é’±åŒ…è°ƒè¯•å·¥å…· - Kronos</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #1a1a1a;
            color: #fff;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: #2a2a2a;
            padding: 30px;
            border-radius: 10px;
        }
        h1 { color: #E6007A; }
        h2 { color: #00B2FF; margin-top: 30px; }
        .status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 5px solid;
        }
        .success { background: #1a3d1a; border-left-color: #28a745; }
        .error { background: #3d1a1a; border-left-color: #dc3545; }
        .warning { background: #3d3d1a; border-left-color: #ffc107; }
        .info { background: #1a2a3d; border-left-color: #17a2b8; }
        button {
            background: #E6007A;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 16px;
        }
        button:hover { background: #c00066; }
        .code {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
            border: 1px solid #444;
        }
        pre {
            margin: 0;
            color: #00ff00;
        }
        .step {
            background: #333;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 3px solid #E6007A;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ é’±åŒ…è¿æ¥è°ƒè¯•å·¥å…·</h1>
        <p>å®æ—¶æ£€æµ‹é’±åŒ…æ‰©å±•å’Œè´¦æˆ·çŠ¶æ€</p>

        <div style="margin: 20px 0;">
            <button onclick="runFullDiagnostic()">ğŸ” å¼€å§‹å®Œæ•´è¯Šæ–­</button>
            <button onclick="checkInjected()">ğŸ“¦ æ£€æŸ¥æ³¨å…¥å¯¹è±¡</button>
            <button onclick="testPolkadotJS()">ğŸ”´ æµ‹è¯• Polkadot.js</button>
            <button onclick="testOKX()">ğŸŸ  æµ‹è¯• OKX</button>
            <button onclick="location.reload()">ğŸ”„ åˆ·æ–°é¡µé¢</button>
        </div>

        <div id="output"></div>

        <div class="info status" style="margin-top: 30px;">
            <strong>ğŸ’¡ å¦‚ä½•ä½¿ç”¨ï¼š</strong>
            <ol>
                <li>ç‚¹å‡»"å¼€å§‹å®Œæ•´è¯Šæ–­"æŒ‰é’®</li>
                <li>æŸ¥çœ‹ä¸‹æ–¹çš„æ£€æµ‹ç»“æœ</li>
                <li>æ ¹æ®æç¤ºæ“ä½œ</li>
                <li>å®Œæˆåé‡æ–°è®¿é—® Kronos DApp</li>
            </ol>
        </div>
    </div>

    <script type="module">
        const output = document.getElementById('output');

        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = message;
            output.appendChild(div);
        }

        function logCode(code) {
            const div = document.createElement('div');
            div.className = 'code';
            div.innerHTML = '<pre>' + code + '</pre>';
            output.appendChild(div);
        }

        // æ£€æŸ¥æµè§ˆå™¨æ³¨å…¥çš„é’±åŒ…å¯¹è±¡
        window.checkInjected = function() {
            output.innerHTML = '<h2>ğŸ“¦ æ£€æŸ¥æµè§ˆå™¨æ³¨å…¥å¯¹è±¡</h2>';
            
            log('æ£€æŸ¥ window.injectedWeb3...', 'info');
            
            if (typeof window.injectedWeb3 !== 'undefined') {
                const wallets = Object.keys(window.injectedWeb3);
                log(`âœ… æ£€æµ‹åˆ° injectedWeb3 å¯¹è±¡<br>æ‰¾åˆ° ${wallets.length} ä¸ªé’±åŒ…: ${wallets.join(', ')}`, 'success');
                
                wallets.forEach(wallet => {
                    const info = window.injectedWeb3[wallet];
                    logCode(`é’±åŒ…: ${wallet}\nç‰ˆæœ¬: ${info.version || 'æœªçŸ¥'}`);
                });
            } else {
                log('âŒ æœªæ£€æµ‹åˆ° injectedWeb3<br>è¿™æ„å‘³ç€æ²¡æœ‰å®‰è£…ä»»ä½• Polkadot å…¼å®¹çš„é’±åŒ…æ‰©å±•', 'error');
            }

            log('æ£€æŸ¥å…¶ä»–é’±åŒ…å¯¹è±¡...', 'info');
            
            const checks = [
                { name: 'Polkadot.js', key: 'polkadot' },
                { name: 'OKX', key: 'okxwallet' },
                { name: 'SubWallet', key: 'subwallet' },
                { name: 'Talisman', key: 'talismanEth' }
            ];

            checks.forEach(check => {
                if (typeof window[check.key] !== 'undefined') {
                    log(`âœ… æ£€æµ‹åˆ° ${check.name} (window.${check.key})`, 'success');
                } else {
                    log(`âŒ æœªæ£€æµ‹åˆ° ${check.name} (window.${check.key})`, 'error');
                }
            });
        };

        // æµ‹è¯• Polkadot.js Extension
        window.testPolkadotJS = async function() {
            output.innerHTML = '<h2>ğŸ”´ æµ‹è¯• Polkadot.js Extension</h2>';
            
            try {
                log('å¯¼å…¥ @polkadot/extension-dapp...', 'info');
                const { web3Enable, web3Accounts } = await import('https://cdn.jsdelivr.net/npm/@polkadot/extension-dapp@0.46.6/+esm');
                
                log('è°ƒç”¨ web3Enable...', 'info');
                const extensions = await web3Enable('Kronos Wallet Debug');
                
                if (extensions.length === 0) {
                    log('âŒ æ²¡æœ‰æ£€æµ‹åˆ°ä»»ä½•æ‰©å±•<br><br><strong>å¯èƒ½çš„åŸå› ï¼š</strong><ul><li>Polkadot.js Extension æœªå®‰è£…</li><li>æ‰©å±•è¢«ç¦ç”¨</li><li>éœ€è¦åˆ·æ–°é¡µé¢</li></ul>', 'error');
                    
                    log('è¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š', 'warning');
                    const steps = `
                        <div class="step">
                            <strong>æ­¥éª¤ 1ï¼š</strong> æ£€æŸ¥æ‰©å±•æ˜¯å¦å·²å®‰è£…<br>
                            â†’ æ‰“å¼€ chrome://extensions/ æŸ¥çœ‹<br>
                            â†’ æœç´¢ "Polkadot"<br>
                            â†’ ç¡®ä¿æ‰©å±•å·²å¯ç”¨ï¼ˆå¼€å…³æ˜¯è“è‰²ï¼‰
                        </div>
                        <div class="step">
                            <strong>æ­¥éª¤ 2ï¼š</strong> å¦‚æœæ²¡æœ‰å®‰è£…<br>
                            â†’ è®¿é—®: <a href="https://polkadot.js.org/extension/" target="_blank" style="color: #00B2FF;">https://polkadot.js.org/extension/</a><br>
                            â†’ å®‰è£…æ‰©å±•
                        </div>
                        <div class="step">
                            <strong>æ­¥éª¤ 3ï¼š</strong> åˆ·æ–°æ­¤é¡µé¢å¹¶é‡æ–°æµ‹è¯•
                        </div>
                    `;
                    output.innerHTML += steps;
                    return;
                }

                log(`âœ… æ£€æµ‹åˆ° ${extensions.length} ä¸ªæ‰©å±•`, 'success');
                extensions.forEach(ext => {
                    logCode(`åç§°: ${ext.name}\nç‰ˆæœ¬: ${ext.version}`);
                });

                log('è·å–è´¦æˆ·åˆ—è¡¨...', 'info');
                const accounts = await web3Accounts();
                
                if (accounts.length === 0) {
                    log('âš ï¸ æ‰©å±•å·²å®‰è£…ï¼Œä½†æ²¡æœ‰è´¦æˆ·<br><br><strong>æ‚¨éœ€è¦åˆ›å»ºè´¦æˆ·ï¼</strong>', 'warning');
                    
                    const createSteps = `
                        <div class="step">
                            <strong>ğŸ”´ Polkadot.js - åˆ›å»ºè´¦æˆ·æ­¥éª¤ï¼š</strong>
                            <ol>
                                <li>ç‚¹å‡»æµè§ˆå™¨å³ä¸Šè§’çš„<strong>çº¢è‰²åœ†ç‚¹</strong>å›¾æ ‡</li>
                                <li>ç‚¹å‡»<strong> [+] </strong>åŠ å·æŒ‰é’®</li>
                                <li>é€‰æ‹© <strong>"Create new account"</strong></li>
                                <li><strong style="color: #ffc107;">ç”¨çº¸ç¬”æŠ„å†™ 12 ä¸ªå•è¯ï¼</strong></li>
                                <li>è¾“å…¥è´¦æˆ·åç§°å’Œå¯†ç </li>
                                <li>ç‚¹å‡»åˆ›å»º</li>
                                <li>åˆ·æ–°æ­¤é¡µé¢é‡æ–°æµ‹è¯•</li>
                            </ol>
                        </div>
                    `;
                    output.innerHTML += createSteps;
                    return;
                }

                log(`ğŸ‰ å¤ªå¥½äº†ï¼æ‰¾åˆ° ${accounts.length} ä¸ªè´¦æˆ·`, 'success');
                accounts.forEach((acc, i) => {
                    logCode(`è´¦æˆ· ${i+1}:\n  åç§°: ${acc.meta.name || 'æœªå‘½å'}\n  åœ°å€: ${acc.address}\n  æ¥æº: ${acc.meta.source}`);
                });

                log('âœ… ä¸€åˆ‡æ­£å¸¸ï¼æ‚¨å¯ä»¥åœ¨ Kronos DApp ä¸­è¿æ¥äº†ï¼', 'success');
                
                output.innerHTML += `
                    <div style="text-align: center; margin-top: 30px;">
                        <a href="http://localhost:3000" style="display: inline-block; background: #28a745; color: white; padding: 15px 40px; text-decoration: none; border-radius: 8px; font-weight: bold;">
                            è¿”å› Kronos DApp â†’
                        </a>
                    </div>
                `;

            } catch (error) {
                log(`âŒ é”™è¯¯: ${error.message}`, 'error');
                logCode(error.stack);
            }
        };

        // æµ‹è¯• OKX Wallet
        window.testOKX = async function() {
            output.innerHTML = '<h2>ğŸŸ  æµ‹è¯• OKX Wallet</h2>';
            
            log('æ£€æŸ¥ window.okxwallet...', 'info');
            
            if (typeof window.okxwallet !== 'undefined') {
                log('âœ… æ£€æµ‹åˆ° OKX Wallet', 'success');
                logCode(JSON.stringify(window.okxwallet, null, 2).slice(0, 500));
            } else {
                log('âŒ æœªæ£€æµ‹åˆ° OKX Wallet', 'error');
                output.innerHTML += `
                    <div class="step">
                        <strong>OKX Wallet æœªå®‰è£…æˆ–æœªå¯ç”¨</strong><br><br>
                        <strong>è§£å†³æ–¹æ³•ï¼š</strong>
                        <ol>
                            <li>è®¿é—®: <a href="https://www.okx.com/web3" target="_blank" style="color: #00B2FF;">https://www.okx.com/web3</a></li>
                            <li>ä¸‹è½½å¹¶å®‰è£…æµè§ˆå™¨æ‰©å±•</li>
                            <li>åˆ·æ–°æ­¤é¡µé¢</li>
                            <li>é‡æ–°æµ‹è¯•</li>
                        </ol>
                    </div>
                `;
                return;
            }

            log('æµ‹è¯• Polkadot æ‰©å±•æ¥å£...', 'info');
            
            try {
                const { web3Enable, web3Accounts } = await import('https://cdn.jsdelivr.net/npm/@polkadot/extension-dapp@0.46.6/+esm');
                const extensions = await web3Enable('OKX Test');
                
                const okxExt = extensions.find(e => e.name.toLowerCase().includes('okx'));
                
                if (okxExt) {
                    log('âœ… OKX çš„ Polkadot æ¥å£å¯ç”¨', 'success');
                    logCode(`åç§°: ${okxExt.name}\nç‰ˆæœ¬: ${okxExt.version}`);
                    
                    const accounts = await web3Accounts();
                    const okxAccounts = accounts.filter(a => a.meta.source.toLowerCase().includes('okx'));
                    
                    if (okxAccounts.length === 0) {
                        log('âš ï¸ OKX å·²å®‰è£…ï¼Œä½†æ²¡æœ‰ Polkadot è´¦æˆ·', 'warning');
                        output.innerHTML += `
                            <div class="step">
                                <strong>ğŸŸ  OKX Wallet - åˆ‡æ¢åˆ° Polkadot ç½‘ç»œï¼š</strong>
                                <ol>
                                    <li>æ‰“å¼€ OKX Wallet æ‰©å±•</li>
                                    <li>ç‚¹å‡»é¡¶éƒ¨ç½‘ç»œåç§°ï¼ˆå¯èƒ½æ˜¾ç¤º "Ethereum Mainnet"ï¼‰</li>
                                    <li>åœ¨æœç´¢æ¡†è¾“å…¥: <strong>Polkadot</strong></li>
                                    <li>é€‰æ‹© <strong>"Polkadot"</strong> æˆ– <strong>"Westend"</strong></li>
                                    <li>ç¡®è®¤é¡¶éƒ¨æ˜¾ç¤º "Polkadot"</li>
                                    <li>è´¦æˆ·åœ°å€åº”è¯¥ä»¥ <strong>5</strong> å¼€å¤´</li>
                                    <li>åˆ·æ–°æ­¤é¡µé¢é‡æ–°æµ‹è¯•</li>
                                </ol>
                            </div>
                        `;
                    } else {
                        log(`âœ… æ‰¾åˆ° ${okxAccounts.length} ä¸ª OKX Polkadot è´¦æˆ·`, 'success');
                        okxAccounts.forEach((acc, i) => {
                            logCode(`è´¦æˆ· ${i+1}:\n  åç§°: ${acc.meta.name}\n  åœ°å€: ${acc.address}`);
                        });
                    }
                } else {
                    log('âš ï¸ OKX å·²å®‰è£…ä½† Polkadot æ¥å£æœªå¯ç”¨', 'warning');
                }
            } catch (error) {
                log(`âŒ æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        };

        // å®Œæ•´è¯Šæ–­
        window.runFullDiagnostic = async function() {
            output.innerHTML = '<h2>ğŸ” å®Œæ•´è¯Šæ–­æŠ¥å‘Š</h2>';
            
            // æ­¥éª¤ 1: æ£€æŸ¥åŸºç¡€ç¯å¢ƒ
            log('æ­¥éª¤ 1/5: æ£€æŸ¥æµè§ˆå™¨ç¯å¢ƒ...', 'info');
            
            const browserInfo = `
                æµè§ˆå™¨: ${navigator.userAgent.split(' ').pop()}
                è¯­è¨€: ${navigator.language}
                å¹³å°: ${navigator.platform}
            `;
            logCode(browserInfo);

            // æ­¥éª¤ 2: æ£€æŸ¥æ³¨å…¥å¯¹è±¡
            log('æ­¥éª¤ 2/5: æ£€æŸ¥é’±åŒ…æ³¨å…¥å¯¹è±¡...', 'info');
            
            const injectedChecks = {
                'injectedWeb3': window.injectedWeb3,
                'polkadot': window.polkadot,
                'okxwallet': window.okxwallet,
                'subwallet': window.SubWallet,
                'talismanEth': window.talismanEth
            };

            let foundWallets = [];
            
            for (const [name, obj] of Object.entries(injectedChecks)) {
                if (typeof obj !== 'undefined') {
                    log(`âœ… æ£€æµ‹åˆ°: window.${name}`, 'success');
                    foundWallets.push(name);
                } else {
                    log(`âŒ æœªæ£€æµ‹åˆ°: window.${name}`, 'error');
                }
            }

            if (foundWallets.length === 0) {
                log('âŒ æ²¡æœ‰æ£€æµ‹åˆ°ä»»ä½•é’±åŒ…å¯¹è±¡ï¼', 'error');
                output.innerHTML += `
                    <div class="step">
                        <strong>âš ï¸ æ²¡æœ‰æ£€æµ‹åˆ°é’±åŒ…æ‰©å±•</strong><br><br>
                        <strong>è¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</strong>
                        <ol>
                            <li><strong>æ£€æŸ¥æ‰©å±•æ˜¯å¦å·²å®‰è£…</strong><br>
                                â†’ åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥: <code>chrome://extensions/</code><br>
                                â†’ æŸ¥çœ‹æ˜¯å¦æœ‰ Polkadot.js æˆ– OKX Wallet</li>
                            <li><strong>ç¡®ä¿æ‰©å±•å·²å¯ç”¨</strong><br>
                                â†’ å¼€å…³åº”è¯¥æ˜¯è“è‰²ï¼ˆå¼€å¯çŠ¶æ€ï¼‰</li>
                            <li><strong>åˆ·æ–°æ­¤é¡µé¢</strong><br>
                                â†’ æŒ‰ F5 æˆ–ç‚¹å‡»ä¸Šæ–¹"åˆ·æ–°é¡µé¢"æŒ‰é’®</li>
                            <li><strong>å¦‚æœä»ç„¶æ£€æµ‹ä¸åˆ°</strong><br>
                                â†’ é‡å¯æµè§ˆå™¨<br>
                                â†’ é‡æ–°è®¿é—®æ­¤é¡µé¢</li>
                        </ol>
                    </div>
                `;
                return;
            }

            // æ­¥éª¤ 3: æµ‹è¯• Polkadot æ‰©å±•æ¥å£
            log('æ­¥éª¤ 3/5: æµ‹è¯• Polkadot æ‰©å±•æ¥å£...', 'info');
            
            try {
                const { web3Enable, web3Accounts, web3AccountsSubscribe } = 
                    await import('https://cdn.jsdelivr.net/npm/@polkadot/extension-dapp@0.46.6/+esm');
                
                log('âœ… Polkadot åº“åŠ è½½æˆåŠŸ', 'success');

                log('è°ƒç”¨ web3Enable...', 'info');
                const extensions = await web3Enable('Kronos Diagnostic Tool');
                
                if (extensions.length === 0) {
                    log('âŒ web3Enable è¿”å›ç©ºæ•°ç»„', 'error');
                    output.innerHTML += `
                        <div class="step">
                            <strong>æ‰©å±•æœªå“åº”</strong><br><br>
                            å¯èƒ½çš„åŸå› ï¼š
                            <ul>
                                <li>é’±åŒ…æ‰©å±•åˆšå®‰è£…ï¼Œéœ€è¦åˆ·æ–°é¡µé¢</li>
                                <li>é’±åŒ…æ‰©å±•ç‰ˆæœ¬è¿‡æ—§</li>
                                <li>æµè§ˆå™¨ç¼“å­˜é—®é¢˜</li>
                            </ul>
                            <strong>è§£å†³æ–¹æ³•ï¼š</strong>
                            <ol>
                                <li>åˆ·æ–°æ­¤é¡µé¢ï¼ˆF5ï¼‰</li>
                                <li>å¦‚æœè¿˜ä¸è¡Œï¼Œé‡å¯æµè§ˆå™¨</li>
                                <li>ç¡®ä¿é’±åŒ…æ‰©å±•æ˜¯æœ€æ–°ç‰ˆæœ¬</li>
                            </ol>
                        </div>
                    `;
                    return;
                }

                log(`âœ… æ£€æµ‹åˆ° ${extensions.length} ä¸ªæ‰©å±•å“åº”`, 'success');
                extensions.forEach(ext => {
                    logCode(`æ‰©å±•åç§°: ${ext.name}\nç‰ˆæœ¬: ${ext.version}\nç±»å‹: ${ext.type || 'æ ‡å‡†'}`);
                });

                // æ­¥éª¤ 4: è·å–è´¦æˆ·
                log('æ­¥éª¤ 4/5: è·å–è´¦æˆ·åˆ—è¡¨...', 'info');
                
                const accounts = await web3Accounts();
                
                if (accounts.length === 0) {
                    log('âš ï¸ æ‰©å±•æ­£å¸¸ï¼Œä½†æ²¡æœ‰è´¦æˆ·', 'warning');
                    
                    output.innerHTML += `
                        <div class="step">
                            <strong>âœ… é’±åŒ…æ‰©å±•å·¥ä½œæ­£å¸¸</strong><br>
                            <strong>âŒ ä½†æ‚¨è¿˜æ²¡æœ‰åˆ›å»ºè´¦æˆ·</strong><br><br>
                            
                            <strong>ç«‹å³åˆ›å»ºè´¦æˆ·ï¼š</strong>
                        </div>
                    `;

                    const hasPolkadotJS = extensions.some(e => e.name.includes('polkadot-js'));
                    const hasOKX = extensions.some(e => e.name.toLowerCase().includes('okx'));

                    if (hasPolkadotJS) {
                        output.innerHTML += `
                            <div class="step" style="border-left-color: #dc3545;">
                                <strong>ğŸ”´ åœ¨ Polkadot.js ä¸­åˆ›å»ºè´¦æˆ·ï¼š</strong>
                                <ol>
                                    <li>ç‚¹å‡»æµè§ˆå™¨å³ä¸Šè§’çš„<strong>çº¢è‰²åœ†ç‚¹</strong>å›¾æ ‡</li>
                                    <li>ç‚¹å‡»<strong> [+] </strong>åŠ å·æŒ‰é’®</li>
                                    <li>é€‰æ‹© <strong>"Create new account"</strong></li>
                                    <li><strong style="color: #ffc107;">ç”¨çº¸ç¬”æŠ„å†™ 12 ä¸ªåŠ©è®°è¯ï¼</strong></li>
                                    <li>è¾“å…¥è´¦æˆ·åç§°ï¼ˆå¦‚ï¼šKronosï¼‰</li>
                                    <li>è®¾ç½®å¯†ç </li>
                                    <li>ç‚¹å‡»åˆ›å»º</li>
                                    <li>åˆ·æ–°æ­¤é¡µé¢é‡æ–°è¯Šæ–­</li>
                                </ol>
                            </div>
                        `;
                    }

                    if (hasOKX) {
                        output.innerHTML += `
                            <div class="step" style="border-left-color: #ff9800;">
                                <strong>ğŸŸ  åœ¨ OKX Wallet ä¸­åˆ›å»ºè´¦æˆ·ï¼š</strong>
                                <ol>
                                    <li>ç‚¹å‡»æµè§ˆå™¨å³ä¸Šè§’çš„ OKX å›¾æ ‡</li>
                                    <li>å¦‚æœæ˜¯é¦–æ¬¡ä½¿ç”¨ï¼Œç‚¹å‡» "åˆ›å»ºé’±åŒ…"</li>
                                    <li>è®¾ç½®å¯†ç å¹¶å¤‡ä»½åŠ©è®°è¯</li>
                                    <li><strong style="color: #dc3545;">é‡è¦ï¼šåˆ‡æ¢ç½‘ç»œï¼</strong></li>
                                    <li>ç‚¹å‡»é¡¶éƒ¨ "Ethereum Mainnet"</li>
                                    <li>æœç´¢ "Polkadot"</li>
                                    <li>é€‰æ‹© Polkadot ç½‘ç»œ</li>
                                    <li>ç¡®è®¤é¡¶éƒ¨æ˜¾ç¤º "Polkadot"</li>
                                    <li>åˆ·æ–°æ­¤é¡µé¢é‡æ–°è¯Šæ–­</li>
                                </ol>
                            </div>
                        `;
                    }

                    return;
                }

                // æœ‰è´¦æˆ· - æˆåŠŸï¼
                log(`ğŸ‰ å®Œç¾ï¼æ‰¾åˆ° ${accounts.length} ä¸ªè´¦æˆ·`, 'success');
                
                accounts.forEach((acc, i) => {
                    const addrShort = `${acc.address.slice(0, 8)}...${acc.address.slice(-6)}`;
                    output.innerHTML += `
                        <div class="account-card">
                            <strong>è´¦æˆ· ${i+1}: ${acc.meta.name || 'æœªå‘½å'}</strong><br>
                            <small style="color: #aaa;">åœ°å€: ${addrShort}</small><br>
                            <small style="color: #888;">æ¥æº: ${acc.meta.source}</small>
                        </div>
                    `;
                });

                // æ­¥éª¤ 5: æœ€ç»ˆç»“æœ
                log('æ­¥éª¤ 5/5: è¯Šæ–­å®Œæˆ', 'info');
                
                output.innerHTML += `
                    <div class="success status">
                        <h3>âœ… è¯Šæ–­ç»“æœï¼šä¸€åˆ‡æ­£å¸¸ï¼</h3>
                        <p style="margin-top: 10px;">æ‚¨çš„é’±åŒ…é…ç½®å®Œå…¨æ­£ç¡®ï¼Œå¯ä»¥åœ¨ Kronos DApp ä¸­ä½¿ç”¨äº†ï¼</p>
                        <br>
                        <strong>ä¸‹ä¸€æ­¥ï¼š</strong>
                        <ol>
                            <li>è¿”å› Kronos DApp: <a href="http://localhost:3000" target="_blank" style="color: #00ff00;">http://localhost:3000</a></li>
                            <li>ç‚¹å‡»å³ä¸Šè§’ "Connect Wallet"</li>
                            <li>é€‰æ‹©é’±åŒ…ï¼ˆåº”è¯¥èƒ½çœ‹åˆ°é’±åŒ…åˆ—è¡¨äº†ï¼‰</li>
                            <li>é€‰æ‹©è´¦æˆ·å¹¶æˆæƒ</li>
                            <li>å¼€å§‹é¢„æµ‹ï¼ğŸš€</li>
                        </ol>
                    </div>
                    <div style="text-align: center; margin-top: 30px;">
                        <a href="http://localhost:3000" style="display: inline-block; background: #28a745; color: white; padding: 15px 40px; text-decoration: none; border-radius: 8px; font-weight: bold; font-size: 1.2em;">
                            ğŸš€ è¿”å› Kronos DApp
                        </a>
                    </div>
                `;

            } catch (error) {
                log(`âŒ æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                logCode(error.stack);
            }
        };

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œè¯Šæ–­
        window.addEventListener('load', () => {
            setTimeout(() => {
                log('é¡µé¢å·²åŠ è½½ï¼Œå‡†å¤‡å¼€å§‹è¯Šæ–­...', 'info');
                log('è¯·ç‚¹å‡»ä¸Šæ–¹"å¼€å§‹å®Œæ•´è¯Šæ–­"æŒ‰é’®', 'warning');
            }, 500);
        });
    </script>
</body>
</html>

